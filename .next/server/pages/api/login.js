"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/login";
exports.ids = ["pages/api/login"];
exports.modules = {

/***/ "@hapi/joi":
/*!****************************!*\
  !*** external "@hapi/joi" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("@hapi/joi");

/***/ }),

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "cookie":
/*!*************************!*\
  !*** external "cookie" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("cookie");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "(api)/./helpers/validation.ts":
/*!*******************************!*\
  !*** ./helpers/validation.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"validateReg\": () => (/* binding */ validateReg),\n/* harmony export */   \"validateLogin\": () => (/* binding */ validateLogin)\n/* harmony export */ });\n/* harmony import */ var _hapi_joi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @hapi/joi */ \"@hapi/joi\");\n/* harmony import */ var _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_hapi_joi__WEBPACK_IMPORTED_MODULE_0__);\n\n//Register validation\nfunction validateReg(data) {\n    const schema = _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default().object({\n        name: _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default().string().min(3).regex(/^[a-zA-Zа-яёА-ЯЁ ]+$/u).required().messages({\n            \"string.empty\": `Имя не может быть пустым`,\n            \"string.min\": `Имя должен быть более 2 символов`,\n            \"string.pattern.base\": `Просим использовать допустимые символы: кирилица или латинский алфавит вам в помощь`\n        }),\n        email: _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default().string().min(6).required().email().messages({\n            \"string.empty\": `Email не может быть пустым`,\n            \"string.min\": `Email должен быть более 6 символов`,\n            \"string.email\": `Введите действующий Email`\n        }),\n        password: _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default().string().min(6).required().messages({\n            \"string.empty\": `Пароль не может быть пустым`,\n            \"string.min\": `Пароль должен быть более 6 символов`\n        }),\n        workPlace: _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default().string().regex(/^[a-zA-Zа-яёА-ЯЁ0-9 _]+$/u).min(3).required().messages({\n            \"string.empty\": `Место работы не может быть пустым`,\n            \"string.min\": `Место работы должно быть более 2 символов`,\n            \"string.pattern.base\": `Просим использовать допустимые символы: кирилица или латинский алфавит вам в помощь`\n        })\n    });\n    const { error  } = schema.validate(data);\n    console.log(error);\n    return error;\n}\n//Login validation\nfunction validateLogin(data) {\n    const schema = _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default().object({\n        email: _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default().string().email().min(6).required().messages({\n            \"string.empty\": `Email не может быть пустым`,\n            \"string.min\": `Проверьте Email`,\n            \"string.email\": `Введите действующий Email`\n        }),\n        password: _hapi_joi__WEBPACK_IMPORTED_MODULE_0___default().string().min(6).required().messages({\n            \"string.empty\": `Пароль не может быть пустым`,\n            \"string.min\": `Проверьте пароль`\n        })\n    });\n    const { error  } = schema.validate(data);\n    return error;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9oZWxwZXJzL3ZhbGlkYXRpb24udHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE0QjtBQUc1QixxQkFBcUI7QUFDZCxTQUFTQyxXQUFXLENBQUNDLElBQXVCLEVBQUU7SUFDbkQsTUFBTUMsTUFBTSxHQUFHSCx1REFBVSxDQUFDO1FBQ3hCSyxJQUFJLEVBQUVMLHVEQUFVLEVBQUUsQ0FDZk8sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUNOQyxLQUFLLCtCQUF5QixDQUN4QkMsUUFBRSxFQUFFLENBQ1ZDO1lBQ0MsY0FBYyxFQUFFLENBQUM7WUFDRyxZQUFSLEVBQUUsQ0FBQztZQUNXLHFCQUFMLEVBQUUsQ0FBQztTQUMrQyxDQUF2RTtRQUNKQyxLQUFLLEVBQUVYLHVEQUFVLEVBQUUsQ0FBQ08sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDRSxRQUFRLEVBQUUsQ0FBQ0UsS0FBSyxFQUFFLENBQUNELFFBQVEsQ0FBQztZQUNyRCxjQUFjLEVBQUUsQ0FBQztZQUNBLFlBQUwsRUFBRSxDQUFDO1lBQ1EsY0FBVCxFQUFFLENBQUM7U0FDQSxDQUFqQjtRQUNGRSxRQUFRLEVBQUVaLHVEQUFVLEVBQUUsQ0FBQ08sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDRSxRQUFRLEVBQUUsQ0FBQ0MsUUFBUSxDQUFDO1lBQ2hELGNBQWMsRUFBRSxDQUFDO1lBQ00sWUFBWCxFQUFFLENBQUM7U0FDYSxDQUE1QjtRQUNGRyxTQUFTLEVBQUViLHVEQUFVLEVBQUUsQ0FDcEJRLEtBQUssbUNBQTZCLENBQzVCRCxHQUFILENBQUMsQ0FBQyxDQUFDLENBQ05FLFFBQVEsRUFBRSxDQUNWQztZQUNDLGNBQWMsRUFBRSxDQUFDO1lBQ1csWUFBaEIsRUFBRSxDQUFDO1lBQ21CLHFCQUFiLEVBQUUsQ0FBQztTQUMrQyxDQUF2RTtLQUNMLENBQUM7SUFFRixNQUFNLEVBQUVJLEtBQUssR0FBRSxHQUFHWCxNQUFNLENBQUNZLFFBQVEsQ0FBQ2IsSUFBSSxDQUFDO0lBQ3ZDYyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0gsS0FBSyxDQUFDLENBQUM7SUFDbkIsT0FBT0EsS0FBSyxDQUFDO0NBQ2Q7QUFFRCxrQkFBa0I7QUFFWCxTQUFTSSxhQUFhLENBQUNoQixJQUFJLEVBQUU7SUFDbEMsTUFBTUMsTUFBTSxHQUFHSCx1REFBVSxDQUFDO1FBQ3hCVyxLQUFLLEVBQUVYLHVEQUFVLEVBQUUsQ0FBQ1csS0FBSyxFQUFFLENBQUNKLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQ0UsUUFBUSxFQUFFLENBQUNDLFFBQVEsQ0FBQztZQUNyRCxjQUFjLEVBQUUsQ0FBQztZQUNBLFlBQUwsRUFBRSxDQUFDO1lBQ04sY0FBSyxFQUFFLENBQUM7U0FDQSxDQUFqQjtRQUNGRSxRQUFRLEVBQUVaLHVEQUFVLEVBQUUsQ0FBQ08sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDRSxRQUFRLEVBQUUsQ0FBQ0MsUUFBUSxDQUFDO1lBQ2hELGNBQWMsRUFBRSxDQUFDO1lBQ00sWUFBWCxFQUFFLENBQUM7U0FDaEIsQ0FBQztLQUNILENBQUM7SUFDRixNQUFNLEVBQUVJLEtBQUssR0FBRSxHQUFHWCxNQUFNLENBQUNZLFFBQVEsQ0FBQ2IsSUFBSSxDQUFDO0lBQ3ZDLE9BQU9ZLEtBQUssQ0FBQztDQUNkIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vaGVscGVycy92YWxpZGF0aW9uLnRzP2MwNTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEpvaSBmcm9tIFwiQGhhcGkvam9pXCI7XG5pbXBvcnQgeyBSZWdpc3RlcmF0aW9uRGF0YSB9IGZyb20gXCIuLi9wYWdlcy9hcGkvcmVnaXN0ZXJcIjtcblxuLy9SZWdpc3RlciB2YWxpZGF0aW9uXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVSZWcoZGF0YTogUmVnaXN0ZXJhdGlvbkRhdGEpIHtcbiAgY29uc3Qgc2NoZW1hID0gSm9pLm9iamVjdCh7XG4gICAgbmFtZTogSm9pLnN0cmluZygpXG4gICAgICAubWluKDMpXG4gICAgICAucmVnZXgoL15bYS16QS1a0LAt0Y/RkdCQLdCv0IEgXSskL3UpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLm1lc3NhZ2VzKHtcbiAgICAgICAgXCJzdHJpbmcuZW1wdHlcIjogYNCY0LzRjyDQvdC1INC80L7QttC10YIg0LHRi9GC0Ywg0L/Rg9GB0YLRi9C8YCxcbiAgICAgICAgXCJzdHJpbmcubWluXCI6IGDQmNC80Y8g0LTQvtC70LbQtdC9INCx0YvRgtGMINCx0L7Qu9C10LUgMiDRgdC40LzQstC+0LvQvtCyYCxcbiAgICAgICAgXCJzdHJpbmcucGF0dGVybi5iYXNlXCI6IGDQn9GA0L7RgdC40Lwg0LjRgdC/0L7Qu9GM0LfQvtCy0LDRgtGMINC00L7Qv9GD0YHRgtC40LzRi9C1INGB0LjQvNCy0L7Qu9GLOiDQutC40YDQuNC70LjRhtCwINC40LvQuCDQu9Cw0YLQuNC90YHQutC40Lkg0LDQu9GE0LDQstC40YIg0LLQsNC8INCyINC/0L7QvNC+0YnRjGAsXG4gICAgICB9KSxcbiAgICBlbWFpbDogSm9pLnN0cmluZygpLm1pbig2KS5yZXF1aXJlZCgpLmVtYWlsKCkubWVzc2FnZXMoe1xuICAgICAgXCJzdHJpbmcuZW1wdHlcIjogYEVtYWlsINC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQv9GD0YHRgtGL0LxgLFxuICAgICAgXCJzdHJpbmcubWluXCI6IGBFbWFpbCDQtNC+0LvQttC10L0g0LHRi9GC0Ywg0LHQvtC70LXQtSA2INGB0LjQvNCy0L7Qu9C+0LJgLFxuICAgICAgXCJzdHJpbmcuZW1haWxcIjogYNCS0LLQtdC00LjRgtC1INC00LXQudGB0YLQstGD0Y7RidC40LkgRW1haWxgLFxuICAgIH0pLFxuICAgIHBhc3N3b3JkOiBKb2kuc3RyaW5nKCkubWluKDYpLnJlcXVpcmVkKCkubWVzc2FnZXMoe1xuICAgICAgXCJzdHJpbmcuZW1wdHlcIjogYNCf0LDRgNC+0LvRjCDQvdC1INC80L7QttC10YIg0LHRi9GC0Ywg0L/Rg9GB0YLRi9C8YCxcbiAgICAgIFwic3RyaW5nLm1pblwiOiBg0J/QsNGA0L7Qu9GMINC00L7Qu9C20LXQvSDQsdGL0YLRjCDQsdC+0LvQtdC1IDYg0YHQuNC80LLQvtC70L7QsmAsXG4gICAgfSksXG4gICAgd29ya1BsYWNlOiBKb2kuc3RyaW5nKClcbiAgICAgIC5yZWdleCgvXlthLXpBLVrQsC3Rj9GR0JAt0K/QgTAtOSBfXSskL3UpXG4gICAgICAubWluKDMpXG4gICAgICAucmVxdWlyZWQoKVxuICAgICAgLm1lc3NhZ2VzKHtcbiAgICAgICAgXCJzdHJpbmcuZW1wdHlcIjogYNCc0LXRgdGC0L4g0YDQsNCx0L7RgtGLINC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQv9GD0YHRgtGL0LxgLFxuICAgICAgICBcInN0cmluZy5taW5cIjogYNCc0LXRgdGC0L4g0YDQsNCx0L7RgtGLINC00L7Qu9C20L3QviDQsdGL0YLRjCDQsdC+0LvQtdC1IDIg0YHQuNC80LLQvtC70L7QsmAsXG4gICAgICAgIFwic3RyaW5nLnBhdHRlcm4uYmFzZVwiOiBg0J/RgNC+0YHQuNC8INC40YHQv9C+0LvRjNC30L7QstCw0YLRjCDQtNC+0L/Rg9GB0YLQuNC80YvQtSDRgdC40LzQstC+0LvRizog0LrQuNGA0LjQu9C40YbQsCDQuNC70Lgg0LvQsNGC0LjQvdGB0LrQuNC5INCw0LvRhNCw0LLQuNGCINCy0LDQvCDQsiDQv9C+0LzQvtGJ0YxgLFxuICAgICAgfSksXG4gIH0pO1xuXG4gIGNvbnN0IHsgZXJyb3IgfSA9IHNjaGVtYS52YWxpZGF0ZShkYXRhKTtcbiAgY29uc29sZS5sb2coZXJyb3IpO1xuICByZXR1cm4gZXJyb3I7XG59XG5cbi8vTG9naW4gdmFsaWRhdGlvblxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVMb2dpbihkYXRhKSB7XG4gIGNvbnN0IHNjaGVtYSA9IEpvaS5vYmplY3Qoe1xuICAgIGVtYWlsOiBKb2kuc3RyaW5nKCkuZW1haWwoKS5taW4oNikucmVxdWlyZWQoKS5tZXNzYWdlcyh7XG4gICAgICBcInN0cmluZy5lbXB0eVwiOiBgRW1haWwg0L3QtSDQvNC+0LbQtdGCINCx0YvRgtGMINC/0YPRgdGC0YvQvGAsXG4gICAgICBcInN0cmluZy5taW5cIjogYNCf0YDQvtCy0LXRgNGM0YLQtSBFbWFpbGAsXG4gICAgICBcInN0cmluZy5lbWFpbFwiOiBg0JLQstC10LTQuNGC0LUg0LTQtdC50YHRgtCy0YPRjtGJ0LjQuSBFbWFpbGAsXG4gICAgfSksXG4gICAgcGFzc3dvcmQ6IEpvaS5zdHJpbmcoKS5taW4oNikucmVxdWlyZWQoKS5tZXNzYWdlcyh7XG4gICAgICBcInN0cmluZy5lbXB0eVwiOiBg0J/QsNGA0L7Qu9GMINC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQv9GD0YHRgtGL0LxgLFxuICAgICAgXCJzdHJpbmcubWluXCI6IGDQn9GA0L7QstC10YDRjNGC0LUg0L/QsNGA0L7Qu9GMYCxcbiAgICB9KSxcbiAgfSk7XG4gIGNvbnN0IHsgZXJyb3IgfSA9IHNjaGVtYS52YWxpZGF0ZShkYXRhKTtcbiAgcmV0dXJuIGVycm9yO1xufVxuIl0sIm5hbWVzIjpbIkpvaSIsInZhbGlkYXRlUmVnIiwiZGF0YSIsInNjaGVtYSIsIm9iamVjdCIsIm5hbWUiLCJzdHJpbmciLCJtaW4iLCJyZWdleCIsInJlcXVpcmVkIiwibWVzc2FnZXMiLCJlbWFpbCIsInBhc3N3b3JkIiwid29ya1BsYWNlIiwiZXJyb3IiLCJ2YWxpZGF0ZSIsImNvbnNvbGUiLCJsb2ciLCJ2YWxpZGF0ZUxvZ2luIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./helpers/validation.ts\n");

/***/ }),

/***/ "(api)/./lib/auth/index.ts":
/*!***************************!*\
  !*** ./lib/auth/index.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"cookieOptions\": () => (/* binding */ cookieOptions),\n/* harmony export */   \"setCookie\": () => (/* binding */ setCookie),\n/* harmony export */   \"userFromRequest\": () => (/* binding */ userFromRequest)\n/* harmony export */ });\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../models/User */ \"(api)/./models/User.ts\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! cookie */ \"cookie\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(cookie__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n\n// import { verifyPassword } from \"./passwordUtils\";\n\n\nconst JWT_TOKEN_KEY = process.env.TOKEN_SECRET;\nconst cookieOptions = {\n    httpOnly: true,\n    maxAge: 2592000,\n    path: \"/\",\n    sameSite: \"Strict\",\n    secure: \"development\" === \"production\"\n};\nfunction setCookie(res, name, value, options = {}) {\n    const stringValue = typeof value === \"object\" ? `j:${JSON.stringify(value)}` : String(value);\n    res.setHeader(\"Set-Cookie\", (0,cookie__WEBPACK_IMPORTED_MODULE_1__.serialize)(name, stringValue, options));\n}\nasync function userFromRequest(req) {\n    const { auth: token  } = req.cookies;\n    console.log({\n        token\n    });\n    if (!token) return undefined;\n    try {\n        const { email  } = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default().verify(token, JWT_TOKEN_KEY);\n        console.log({\n            email\n        });\n        if (!email) return undefined;\n        const user = await _models_User__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findOne({\n            email\n        });\n        console.log({\n            user\n        });\n        if (user) user.password = \"\";\n        return user;\n    } catch (error) {\n        return undefined;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXV0aC9pbmRleC50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFtRDtBQUNuRCxvREFBb0Q7QUFDakI7QUFHSjtBQU8vQixNQUFNRyxhQUFhLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxZQUFZO0FBRXZDLE1BQU1DLGFBQWEsR0FBRztJQUMzQkMsUUFBUSxFQUFFLElBQUk7SUFDZEMsTUFBTSxFQUFFLE9BQU87SUFDZkMsSUFBSSxFQUFFLEdBQUc7SUFDVEMsUUFBUSxFQUFFLFFBQVE7SUFDbEJDLE1BQU0sRUFBRVIsYUFuQkcsS0FtQnNCLFlBQVk7Q0FDOUMsQ0FBQztBQUVLLFNBQVNTLFNBQVMsQ0FDdkJDLEdBQVEsRUFDUkMsSUFBWSxFQUNaQyxLQUFhLEVBQ2JDLE9BQWdDLEdBQUcsRUFBRSxFQUMvQjtJQUNOLE1BQU1DLFdBQVcsR0FDZixPQUFPRixLQUFLLEtBQUssUUFBUSxHQUFHLENBQUMsRUFBRSxFQUFFRyxJQUFJLENBQUNDLFNBQVMsQ0FBQ0osS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHSyxNQUFNLENBQUNMLEtBQUssQ0FBQztJQUUxRUYsR0FBRyxDQUFDUSxTQUFTLENBQUMsWUFBWSxFQUFFckIsaURBQVMsQ0FBQ2MsSUFBSSxFQUFFRyxXQUFXLEVBQUVELE9BQU8sQ0FBQyxDQUFDLENBQUM7Q0FDcEU7QUFFTSxlQUFlTSxlQUFlLENBQ25DQyxHQUF5RCxFQUMxQjtJQUMvQixNQUFNLEVBQUVDLElBQUksRUFBRUMsS0FBSyxHQUFFLEdBQUdGLEdBQUcsQ0FBQ0csT0FBTztJQUNuQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUM7UUFBRUgsS0FBSztLQUFFLENBQUMsQ0FBQztJQUV2QixJQUFJLENBQUNBLEtBQUssRUFBRSxPQUFPSSxTQUFTLENBQUM7SUFFN0IsSUFBSTtRQUNGLE1BQU0sRUFBRUMsS0FBSyxHQUFFLEdBQUc3QiwwREFBVSxDQUFDd0IsS0FBSyxFQUFFdkIsYUFBYSxDQUFDO1FBQ2xEeUIsT0FBTyxDQUFDQyxHQUFHLENBQUM7WUFBRUUsS0FBSztTQUFFLENBQUMsQ0FBQztRQUV2QixJQUFJLENBQUNBLEtBQUssRUFBRSxPQUFPRCxTQUFTLENBQUM7UUFFN0IsTUFBTUcsSUFBSSxHQUFHLE1BQU1qQyw0REFBWSxDQUFDO1lBQzlCK0IsS0FBSztTQUNOLENBQUM7UUFDRkgsT0FBTyxDQUFDQyxHQUFHLENBQUM7WUFBRUksSUFBSTtTQUFFLENBQUMsQ0FBQztRQUV0QixJQUFJQSxJQUFJLEVBQUVBLElBQUksQ0FBQ0UsUUFBUSxHQUFHLEVBQUUsQ0FBQztRQUU3QixPQUFPRixJQUFJLENBQUM7S0FDYixDQUFDLE9BQU9HLEtBQUssRUFBRTtRQUNkLE9BQU9OLFNBQVMsQ0FBQztLQUNsQjtDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbGliL2F1dGgvaW5kZXgudHM/NTY4ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVXNlciwgeyBVc2VyVHlwZSB9IGZyb20gXCIuLi8uLi9tb2RlbHMvVXNlclwiO1xuLy8gaW1wb3J0IHsgdmVyaWZ5UGFzc3dvcmQgfSBmcm9tIFwiLi9wYXNzd29yZFV0aWxzXCI7XG5pbXBvcnQgeyBzZXJpYWxpemUgfSBmcm9tIFwiY29va2llXCI7XG5pbXBvcnQgeyBJbmNvbWluZ01lc3NhZ2UgfSBmcm9tIFwiaHR0cFwiO1xuaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3RDb29raWVzIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYXBpLXV0aWxzXCI7XG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcblxuZXhwb3J0IGludGVyZmFjZSBMb2dpblBhcmFtcyB7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIHBhc3N3b3JkOiBzdHJpbmc7XG59XG5cbmNvbnN0IEpXVF9UT0tFTl9LRVkgPSBwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQ7XG5cbmV4cG9ydCBjb25zdCBjb29raWVPcHRpb25zID0ge1xuICBodHRwT25seTogdHJ1ZSxcbiAgbWF4QWdlOiAyNTkyMDAwLFxuICBwYXRoOiBcIi9cIixcbiAgc2FtZVNpdGU6IFwiU3RyaWN0XCIsXG4gIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwicHJvZHVjdGlvblwiLFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHNldENvb2tpZShcbiAgcmVzOiBhbnksXG4gIG5hbWU6IHN0cmluZyxcbiAgdmFsdWU6IHN0cmluZyxcbiAgb3B0aW9uczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSB7fVxuKTogdm9pZCB7XG4gIGNvbnN0IHN0cmluZ1ZhbHVlID1cbiAgICB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgPyBgajoke0pTT04uc3RyaW5naWZ5KHZhbHVlKX1gIDogU3RyaW5nKHZhbHVlKTtcblxuICByZXMuc2V0SGVhZGVyKFwiU2V0LUNvb2tpZVwiLCBzZXJpYWxpemUobmFtZSwgc3RyaW5nVmFsdWUsIG9wdGlvbnMpKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVzZXJGcm9tUmVxdWVzdChcbiAgcmVxOiBJbmNvbWluZ01lc3NhZ2UgJiB7IGNvb2tpZXM6IE5leHRBcGlSZXF1ZXN0Q29va2llcyB9XG4pOiBQcm9taXNlPFVzZXJUeXBlIHwgdW5kZWZpbmVkPiB7XG4gIGNvbnN0IHsgYXV0aDogdG9rZW4gfSA9IHJlcS5jb29raWVzO1xuICBjb25zb2xlLmxvZyh7IHRva2VuIH0pO1xuXG4gIGlmICghdG9rZW4pIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB7IGVtYWlsIH0gPSBqd3QudmVyaWZ5KHRva2VuLCBKV1RfVE9LRU5fS0VZKTtcbiAgICBjb25zb2xlLmxvZyh7IGVtYWlsIH0pO1xuXG4gICAgaWYgKCFlbWFpbCkgcmV0dXJuIHVuZGVmaW5lZDtcblxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoe1xuICAgICAgZW1haWwsXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coeyB1c2VyIH0pO1xuXG4gICAgaWYgKHVzZXIpIHVzZXIucGFzc3dvcmQgPSBcIlwiO1xuXG4gICAgcmV0dXJuIHVzZXI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlVzZXIiLCJzZXJpYWxpemUiLCJqd3QiLCJKV1RfVE9LRU5fS0VZIiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsImNvb2tpZU9wdGlvbnMiLCJodHRwT25seSIsIm1heEFnZSIsInBhdGgiLCJzYW1lU2l0ZSIsInNlY3VyZSIsInNldENvb2tpZSIsInJlcyIsIm5hbWUiLCJ2YWx1ZSIsIm9wdGlvbnMiLCJzdHJpbmdWYWx1ZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJTdHJpbmciLCJzZXRIZWFkZXIiLCJ1c2VyRnJvbVJlcXVlc3QiLCJyZXEiLCJhdXRoIiwidG9rZW4iLCJjb29raWVzIiwiY29uc29sZSIsImxvZyIsInVuZGVmaW5lZCIsImVtYWlsIiwidmVyaWZ5IiwidXNlciIsImZpbmRPbmUiLCJwYXNzd29yZCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/auth/index.ts\n");

/***/ }),

/***/ "(api)/./lib/dbConnect.ts":
/*!**************************!*\
  !*** ./lib/dbConnect.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI;\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable inside .env.local\");\n}\n/**\n * Global is used here to maintain a cached connection across hot reloads\n * in development. This prevents connections growing exponentially\n * during API Route usage.\n */ let cached = global.mongoose;\nif (!cached) {\n    cached = global.mongoose = {\n        conn: null,\n        promise: null\n    };\n}\nasync function dbConnect() {\n    if (cached.conn) {\n        return cached.conn;\n    }\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false\n        };\n        cached.promise = mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(MONGODB_URI, opts).then((mongoose1)=>{\n            return mongoose1;\n        });\n    }\n    cached.conn = await cached.promise;\n    return cached.conn;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (dbConnect);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZGJDb25uZWN0LnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFnQztBQUVoQyxNQUFNQyxXQUFXLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixXQUFXO0FBRTNDLElBQUksQ0FBQ0EsV0FBVyxFQUFFO0lBQ2hCLE1BQU0sSUFBSUcsS0FBSyxDQUNiLHNFQUFzRSxDQUN2RSxDQUFDO0NBQ0g7QUFFRDs7OztHQUlHLENBQ0gsSUFBSUMsTUFBTSxHQUFHQyxNQUFNLENBQUNOLFFBQVE7QUFFNUIsSUFBSSxDQUFDSyxNQUFNLEVBQUU7SUFDWEEsTUFBTSxHQUFHQyxNQUFNLENBQUNOLFFBQVEsR0FBRztRQUFFTyxJQUFJLEVBQUUsSUFBSTtRQUFFQyxPQUFPLEVBQUUsSUFBSTtLQUFFLENBQUM7Q0FDMUQ7QUFFRCxlQUFlQyxTQUFTLEdBQUc7SUFDekIsSUFBSUosTUFBTSxDQUFDRSxJQUFJLEVBQUU7UUFDZixPQUFPRixNQUFNLENBQUNFLElBQUksQ0FBQztLQUNwQjtJQUVELElBQUksQ0FBQ0YsTUFBTSxDQUFDRyxPQUFPLEVBQUU7UUFDbkIsTUFBTUUsSUFBSSxHQUFHO1lBQ1hDLGNBQWMsRUFBRSxLQUFLO1NBQ3RCO1FBRUROLE1BQU0sQ0FBQ0csT0FBTyxHQUFHUix1REFBZ0IsQ0FBQ0MsV0FBVyxFQUFFUyxJQUFJLENBQUMsQ0FBQ0csSUFBSSxDQUFDLENBQUNiLFNBQVEsR0FBSztZQUN0RSxPQUFPQSxTQUFRLENBQUM7U0FDakIsQ0FBQyxDQUFDO0tBQ0o7SUFDREssTUFBTSxDQUFDRSxJQUFJLEdBQUcsTUFBTUYsTUFBTSxDQUFDRyxPQUFPLENBQUM7SUFDbkMsT0FBT0gsTUFBTSxDQUFDRSxJQUFJLENBQUM7Q0FDcEI7QUFFRCxpRUFBZUUsU0FBUyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbGliL2RiQ29ubmVjdC50cz9jODgzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcblxuY29uc3QgTU9OR09EQl9VUkkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSTtcblxuaWYgKCFNT05HT0RCX1VSSSkge1xuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgXCJQbGVhc2UgZGVmaW5lIHRoZSBNT05HT0RCX1VSSSBlbnZpcm9ubWVudCB2YXJpYWJsZSBpbnNpZGUgLmVudi5sb2NhbFwiXG4gICk7XG59XG5cbi8qKlxuICogR2xvYmFsIGlzIHVzZWQgaGVyZSB0byBtYWludGFpbiBhIGNhY2hlZCBjb25uZWN0aW9uIGFjcm9zcyBob3QgcmVsb2Fkc1xuICogaW4gZGV2ZWxvcG1lbnQuIFRoaXMgcHJldmVudHMgY29ubmVjdGlvbnMgZ3Jvd2luZyBleHBvbmVudGlhbGx5XG4gKiBkdXJpbmcgQVBJIFJvdXRlIHVzYWdlLlxuICovXG5sZXQgY2FjaGVkID0gZ2xvYmFsLm1vbmdvb3NlO1xuXG5pZiAoIWNhY2hlZCkge1xuICBjYWNoZWQgPSBnbG9iYWwubW9uZ29vc2UgPSB7IGNvbm46IG51bGwsIHByb21pc2U6IG51bGwgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZGJDb25uZWN0KCkge1xuICBpZiAoY2FjaGVkLmNvbm4pIHtcbiAgICByZXR1cm4gY2FjaGVkLmNvbm47XG4gIH1cblxuICBpZiAoIWNhY2hlZC5wcm9taXNlKSB7XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIGJ1ZmZlckNvbW1hbmRzOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgY2FjaGVkLnByb21pc2UgPSBtb25nb29zZS5jb25uZWN0KE1PTkdPREJfVVJJLCBvcHRzKS50aGVuKChtb25nb29zZSkgPT4ge1xuICAgICAgcmV0dXJuIG1vbmdvb3NlO1xuICAgIH0pO1xuICB9XG4gIGNhY2hlZC5jb25uID0gYXdhaXQgY2FjaGVkLnByb21pc2U7XG4gIHJldHVybiBjYWNoZWQuY29ubjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZGJDb25uZWN0O1xuIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwiTU9OR09EQl9VUkkiLCJwcm9jZXNzIiwiZW52IiwiRXJyb3IiLCJjYWNoZWQiLCJnbG9iYWwiLCJjb25uIiwicHJvbWlzZSIsImRiQ29ubmVjdCIsIm9wdHMiLCJidWZmZXJDb21tYW5kcyIsImNvbm5lY3QiLCJ0aGVuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/dbConnect.ts\n");

/***/ }),

/***/ "(api)/./models/User.ts":
/*!************************!*\
  !*** ./models/User.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n\nconst userSchema = new (mongoose__WEBPACK_IMPORTED_MODULE_0___default().Schema)({\n    name: {\n        type: String,\n        required: true,\n        min: 6,\n        max: 255\n    },\n    email: {\n        type: String,\n        required: true,\n        max: 255,\n        min: 6\n    },\n    password: {\n        type: String,\n        required: true,\n        max: 1024,\n        min: 6\n    },\n    date: {\n        type: Date,\n        default: Date.now\n    },\n    role: {\n        type: String,\n        default: \"user\"\n    },\n    workPlace: {\n        type: String,\n        required: true\n    }\n});\n// module.exports = mongoose.model('Users', userSchema);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((mongoose__WEBPACK_IMPORTED_MODULE_0___default().models.Users) || mongoose__WEBPACK_IMPORTED_MODULE_0___default().model(\"Users\", userSchema));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9tb2RlbHMvVXNlci50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0M7QUFVaEMsTUFBTUMsVUFBVSxHQUFHLElBQUlELHdEQUFlLENBQVc7SUFDL0NHLElBQUksRUFBRTtRQUNKQyxJQUFJLEVBQUVDLE1BQU07UUFDWkMsUUFBUSxFQUFFLElBQUk7UUFDZEMsR0FBRyxFQUFFLENBQUM7UUFDTkMsR0FBRyxFQUFFLEdBQUc7S0FDVDtJQUNEQyxLQUFLLEVBQUU7UUFDTEwsSUFBSSxFQUFFQyxNQUFNO1FBQ1pDLFFBQVEsRUFBRSxJQUFJO1FBQ2RFLEdBQUcsRUFBRSxHQUFHO1FBQ1JELEdBQUcsRUFBRSxDQUFDO0tBQ1A7SUFDREcsUUFBUSxFQUFFO1FBQ1JOLElBQUksRUFBRUMsTUFBTTtRQUNaQyxRQUFRLEVBQUUsSUFBSTtRQUNkRSxHQUFHLEVBQUUsSUFBSTtRQUNURCxHQUFHLEVBQUUsQ0FBQztLQUNQO0lBQ0RJLElBQUksRUFBRTtRQUNKUCxJQUFJLEVBQUVRLElBQUk7UUFDVkMsT0FBTyxFQUFFRCxJQUFJLENBQUNFLEdBQUc7S0FDbEI7SUFDREMsSUFBSSxFQUFFO1FBQ0pYLElBQUksRUFBRUMsTUFBTTtRQUNaUSxPQUFPLEVBQUUsTUFBTTtLQUNoQjtJQUVERyxTQUFTLEVBQUU7UUFDVFosSUFBSSxFQUFFQyxNQUFNO1FBQ1pDLFFBQVEsRUFBRSxJQUFJO0tBQ2Y7Q0FDRixDQUFDO0FBRUYsd0RBQXdEO0FBQ3hELGlFQUFlTiw4REFBcUIsSUFBSUEscURBQWMsQ0FBQyxPQUFPLEVBQUVDLFVBQVUsQ0FBQyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbW9kZWxzL1VzZXIudHM/NmRjNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5leHBvcnQgdHlwZSBVc2VyVHlwZSA9IHtcbiAgX2lkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbiAgcGFzc3dvcmQ6IHN0cmluZztcbiAgZGF0ZTogRGF0ZTtcbiAgcm9sZTogXCJ1c2VyXCIgfCBcImFkbWluXCI7XG4gIHdvcmtQbGFjZTogc3RyaW5nO1xufTtcbmNvbnN0IHVzZXJTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hPFVzZXJUeXBlPih7XG4gIG5hbWU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgbWluOiA2LFxuICAgIG1heDogMjU1LFxuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICBtYXg6IDI1NSxcbiAgICBtaW46IDYsXG4gIH0sXG4gIHBhc3N3b3JkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIG1heDogMTAyNCxcbiAgICBtaW46IDYsXG4gIH0sXG4gIGRhdGU6IHtcbiAgICB0eXBlOiBEYXRlLFxuICAgIGRlZmF1bHQ6IERhdGUubm93LFxuICB9LFxuICByb2xlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IFwidXNlclwiLFxuICB9LFxuXG4gIHdvcmtQbGFjZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbn0pO1xuXG4vLyBtb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKCdVc2VycycsIHVzZXJTY2hlbWEpO1xuZXhwb3J0IGRlZmF1bHQgbW9uZ29vc2UubW9kZWxzLlVzZXJzIHx8IG1vbmdvb3NlLm1vZGVsKFwiVXNlcnNcIiwgdXNlclNjaGVtYSk7XG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJ1c2VyU2NoZW1hIiwiU2NoZW1hIiwibmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsIm1pbiIsIm1heCIsImVtYWlsIiwicGFzc3dvcmQiLCJkYXRlIiwiRGF0ZSIsImRlZmF1bHQiLCJub3ciLCJyb2xlIiwid29ya1BsYWNlIiwibW9kZWxzIiwiVXNlcnMiLCJtb2RlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./models/User.ts\n");

/***/ }),

/***/ "(api)/./pages/api/login.ts":
/*!****************************!*\
  !*** ./pages/api/login.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _helpers_validation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../helpers/validation */ \"(api)/./helpers/validation.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lib/auth */ \"(api)/./lib/auth/index.ts\");\n/* harmony import */ var _lib_dbConnect__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../lib/dbConnect */ \"(api)/./lib/dbConnect.ts\");\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../models/User */ \"(api)/./models/User.ts\");\n\n\n\n\n\n\nasync function handler(req, res) {\n    const error = (0,_helpers_validation__WEBPACK_IMPORTED_MODULE_2__.validateLogin)(req.body);\n    console.log({\n        error\n    });\n    if (error) {\n        return res.status(400).json({\n            message: error.details[0].message\n        });\n    }\n    await (0,_lib_dbConnect__WEBPACK_IMPORTED_MODULE_4__[\"default\"])();\n    console.log(req.body);\n    //check if email  exists in DB\n    const user = await _models_User__WEBPACK_IMPORTED_MODULE_5__[\"default\"].findOne({\n        email: req.body.email.toLowerCase()\n    });\n    if (!user) {\n        console.log(\"could not find user\");\n        return res.status(400).json({\n            message: \"Email \\u0438\\u043B\\u0438 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C \\u043D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439.\"\n        });\n    }\n    console.log(\"user found in DB\");\n    //password checking\n    const validPass = await bcrypt__WEBPACK_IMPORTED_MODULE_0___default().compare(req.body.password, user.password);\n    if (!validPass) {\n        console.log(\"password is wrong\");\n        return res.status(400).json({\n            message: \"\\u041D\\u0435\\u0432\\u0435\\u0440\\u043D\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n        });\n    }\n    user.password = \"\";\n    console.log(\"password check pass\");\n    //create and assign JSOn token\n    const secret = process.env.TOKEN_SECRET;\n    const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().sign({\n        email: user.email\n    }, secret);\n    (0,_lib_auth__WEBPACK_IMPORTED_MODULE_3__.setCookie)(res, \"auth\", token, _lib_auth__WEBPACK_IMPORTED_MODULE_3__.cookieOptions);\n    res.json(user);\n    console.log(\"token assigned\");\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvbG9naW4udHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQTRCO0FBQ0c7QUFFMEI7QUFDQztBQUNkO0FBQ087QUFFcEMsZUFBZU8sT0FBTyxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsRUFBRTtJQUM5QyxNQUFNQyxLQUFLLEdBQUdSLGtFQUFhLENBQUNNLEdBQUcsQ0FBQ0csSUFBSSxDQUFDO0lBQ3JDQyxPQUFPLENBQUNDLEdBQUcsQ0FBQztRQUFFSCxLQUFLO0tBQUUsQ0FBQyxDQUFDO0lBQ3ZCLElBQUlBLEtBQUssRUFBRTtRQUNULE9BQU9ELEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7WUFBRUMsT0FBTyxFQUFFTixLQUFLLENBQUNPLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQ0QsT0FBTztTQUFFLENBQUMsQ0FBQztLQUNwRTtJQUVELE1BQU1YLDBEQUFTLEVBQUUsQ0FBQztJQUVsQk8sT0FBTyxDQUFDQyxHQUFHLENBQUNMLEdBQUcsQ0FBQ0csSUFBSSxDQUFDLENBQUM7SUFFdEIsOEJBQThCO0lBQzlCLE1BQU1PLElBQUksR0FBRyxNQUFNWiw0REFBWSxDQUFXO1FBQ3hDYyxLQUFLLEVBQUVaLEdBQUcsQ0FBQ0csSUFBSSxDQUFDUyxLQUFLLENBQUNDLFdBQVcsRUFBRTtLQUNwQyxDQUFDO0lBRUYsSUFBSSxDQUFDSCxJQUFJLEVBQUU7UUFDVE4sT0FBTyxDQUFDQyxHQUFHLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUVuQyxPQUFPSixHQUFHLENBQUNLLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1lBQUVDLE9BQU8sRUFBRSxpSEFBNEI7U0FBbUIsQ0FBQyxDQUFDO0tBQ3hFO0lBRWxCSixPQUFPLENBQUNDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0lBRWhDLG1CQUFtQjtJQUNuQixNQUFNUyxTQUFTLEdBQVksTUFBTXRCLHFEQUFjLENBQzdDUSxHQUFHLENBQUNHLElBQUksQ0FBQ2EsUUFBUSxFQUNqQk4sSUFBSSxDQUFDTSxRQUFRLENBQ2Q7SUFDRCxJQUFJLENBQUNGLFNBQVMsRUFBRTtRQUNkVixPQUFPLENBQUNDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1FBRWpDLE9BQU9KLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7WUFBRUMsT0FBTyxFQUFFLHVGQUFpQjtTQUFFLENBQUMsQ0FBQztLQUM3RDtJQUNERSxJQUFJLENBQUNNLFFBQVEsR0FBRyxFQUFFLENBQUM7SUFFbkJaLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLHFCQUFxQixDQUFDLENBQUM7SUFFbkMsOEJBQThCO0lBQzlCLE1BQU1ZLE1BQU0sR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFlBQVk7SUFFdkMsTUFBTUMsS0FBSyxHQUFHNUIsd0RBQVEsQ0FBQztRQUFFbUIsS0FBSyxFQUFFRixJQUFJLENBQUNFLEtBQUs7S0FBRSxFQUFFSyxNQUFNLENBQUM7SUFFckRyQixvREFBUyxDQUFDSyxHQUFHLEVBQUUsTUFBTSxFQUFFb0IsS0FBSyxFQUFFMUIsb0RBQWEsQ0FBQyxDQUFDO0lBRTdDTSxHQUFHLENBQUNNLElBQUksQ0FBQ0csSUFBSSxDQUFDLENBQUM7SUFFZk4sT0FBTyxDQUFDQyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztDQUMvQiIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3BhZ2VzL2FwaS9sb2dpbi50cz9jMTIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdFwiO1xuaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XG5cbmltcG9ydCB7IHZhbGlkYXRlTG9naW4gfSBmcm9tIFwiLi4vLi4vaGVscGVycy92YWxpZGF0aW9uXCI7XG5pbXBvcnQgeyBjb29raWVPcHRpb25zLCBzZXRDb29raWUgfSBmcm9tIFwiLi4vLi4vbGliL2F1dGhcIjtcbmltcG9ydCBkYkNvbm5lY3QgZnJvbSBcIi4uLy4uL2xpYi9kYkNvbm5lY3RcIjtcbmltcG9ydCBVc2VyLCB7IFVzZXJUeXBlIH0gZnJvbSBcIi4uLy4uL21vZGVscy9Vc2VyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgY29uc3QgZXJyb3IgPSB2YWxpZGF0ZUxvZ2luKHJlcS5ib2R5KTtcbiAgY29uc29sZS5sb2coeyBlcnJvciB9KTtcbiAgaWYgKGVycm9yKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IuZGV0YWlsc1swXS5tZXNzYWdlIH0pO1xuICB9XG5cbiAgYXdhaXQgZGJDb25uZWN0KCk7XG5cbiAgY29uc29sZS5sb2cocmVxLmJvZHkpO1xuXG4gIC8vY2hlY2sgaWYgZW1haWwgIGV4aXN0cyBpbiBEQlxuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lPFVzZXJUeXBlPih7XG4gICAgZW1haWw6IHJlcS5ib2R5LmVtYWlsLnRvTG93ZXJDYXNlKCksXG4gIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIGNvbnNvbGUubG9nKFwiY291bGQgbm90IGZpbmQgdXNlclwiKTtcblxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6IFwiRW1haWwg0LjQu9C4INC/0LDRgNC+0LvRjCDQvdC10LLQtdGA0L3Ri9C5LlwiIH0pO1xuICB9XG5cbiAgY29uc29sZS5sb2coXCJ1c2VyIGZvdW5kIGluIERCXCIpO1xuXG4gIC8vcGFzc3dvcmQgY2hlY2tpbmdcbiAgY29uc3QgdmFsaWRQYXNzOiBib29sZWFuID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUoXG4gICAgcmVxLmJvZHkucGFzc3dvcmQsXG4gICAgdXNlci5wYXNzd29yZFxuICApO1xuICBpZiAoIXZhbGlkUGFzcykge1xuICAgIGNvbnNvbGUubG9nKFwicGFzc3dvcmQgaXMgd3JvbmdcIik7XG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiBcItCd0LXQstC10YDQvdGL0Lkg0L/QsNGA0L7Qu9GMXCIgfSk7XG4gIH1cbiAgdXNlci5wYXNzd29yZCA9IFwiXCI7XG5cbiAgY29uc29sZS5sb2coXCJwYXNzd29yZCBjaGVjayBwYXNzXCIpO1xuXG4gIC8vY3JlYXRlIGFuZCBhc3NpZ24gSlNPbiB0b2tlblxuICBjb25zdCBzZWNyZXQgPSBwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQ7XG5cbiAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IGVtYWlsOiB1c2VyLmVtYWlsIH0sIHNlY3JldCk7XG5cbiAgc2V0Q29va2llKHJlcywgXCJhdXRoXCIsIHRva2VuLCBjb29raWVPcHRpb25zKTtcblxuICByZXMuanNvbih1c2VyKTtcblxuICBjb25zb2xlLmxvZyhcInRva2VuIGFzc2lnbmVkXCIpO1xufVxuIl0sIm5hbWVzIjpbImJjcnlwdCIsImp3dCIsInZhbGlkYXRlTG9naW4iLCJjb29raWVPcHRpb25zIiwic2V0Q29va2llIiwiZGJDb25uZWN0IiwiVXNlciIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJlcnJvciIsImJvZHkiLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJkZXRhaWxzIiwidXNlciIsImZpbmRPbmUiLCJlbWFpbCIsInRvTG93ZXJDYXNlIiwidmFsaWRQYXNzIiwiY29tcGFyZSIsInBhc3N3b3JkIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIlRPS0VOX1NFQ1JFVCIsInRva2VuIiwic2lnbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/login.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/login.ts"));
module.exports = __webpack_exports__;

})();